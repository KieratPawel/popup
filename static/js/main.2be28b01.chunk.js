(this.webpackJsonppopup=this.webpackJsonppopup||[]).push([[0],{11:function(e,t,n){},12:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n(5),i=n.n(s),r=n(2),o=n(3),a="initialize",u="change-feature",p="change-amount",l=function(e,t){switch(t.type){case a:return t.payload.pick;case u:return Object(o.a)(Object(o.a)({},e),t.payload);case p:return 0===t.payload.amount?Object(o.a)(Object(o.a)({},e),{},{amount:1}):Object(o.a)(Object(o.a)({},e),{},{amount:t.payload.amount});default:return e}},d=function(e){var t=e.dispatch,n=e.setProduct,c=e.setItems,s=e.setVersions,i=e.setStatus,r=e.source;fetch(r).then((function(e){if(e.ok)return e;throw Error(e.statusText)})).then((function(e){return e.json()})).then((function(e){var r,u=Object(o.a)({},e.product),p=(r=e,Object.values(r.sizes.items)),l=function(e){return Object.values(e.multiversions.find((function(t){return t.id.toString()===e.product.id.toString()})).items).sort((function(e,t){return e.products[0].version_priority-t.products[0].version_priority}))}(e),d=function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}(e.product.id),j={item:p[d?d.itemPick:0],version:l[d?d.versionPick:0],productID:e.product.id,amount:d?d.amount:1,itemPick:0,versionPick:0};n(u),s(l),c(p),t({type:a,payload:{pick:j}}),i("rdy")})).catch((function(e){i("err"),console.error(e)}))},j=n(0),m=function(e){var t=e.items,n=e.pick,c=e.dispatch,s=t.map((function(e,t){return Object(j.jsx)("div",{className:"popup__item ".concat(e.type===n.item.type?"popup__item--active":""),onClick:function(){return c({type:u,payload:{item:e,itemPick:t}})},children:e.name},e.type)}));return Object(j.jsxs)("div",{className:"popup__items",children:["Rozmiar:",Object(j.jsx)("div",{className:"popup__items-container",children:s})]})},b=function(e){var t=e.versions,n=e.dispatch,c=t.map((function(e){return Object(j.jsx)("option",{"data-id":e.values_id,className:"popup__option",children:e.values[e.values_id].name},e.values_id)}));return Object(j.jsxs)("div",{className:"popup__versions",children:["Wariant:",Object(j.jsx)("select",{className:"popup__select",onChange:function(e){var c=t.findIndex((function(t){return t.values_id===e.target[e.target.selectedIndex].dataset.id}));n({type:u,payload:{version:t[c],versionPick:c}})},children:c})]})},O=function(e){var t=e.pick,n=e.dispatch,c=e.setStatus,s=e.setTrigger,i=function(e){if("-"===e)n({type:p,payload:{amount:--t.amount}});else{if("+"!==e)throw new Error("".concat(e," - unknown operator"));n({type:p,payload:{amount:++t.amount}})}},r=!(t.amount>t.item.amount);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"popup__order",children:[r?Object(j.jsxs)("p",{className:"popup__line",children:[Object(j.jsx)("b",{className:"popup__line--green",children:"\xa0\u2714"}),"produkt dost\u0119pny"]}):Object(j.jsxs)("p",{className:"popup__line",children:[Object(j.jsx)("b",{className:"popup__line--red",children:"\u274c"}),"produkt niedost\u0119pny"]}),Object(j.jsxs)("div",{className:"popup__shipping",children:[Object(j.jsx)("span",{className:"popup__icon",children:"\u23f1"}),Object(j.jsxs)("div",{className:"popup__shipping-container",children:[Object(j.jsx)("p",{className:"popup__line",children:"Mo\u017cemy wys\u0142a\u0107 ju\u017c dzisiaj"}),Object(j.jsx)("a",{className:"popup__link",href:"https://www.dhl.com/",target:"_blank",rel:"noreferrer",children:"Sprawd\u017a czasy i koszty wysy\u0142ki"})]})]})]}),Object(j.jsxs)("div",{className:"popup__order",children:[Object(j.jsxs)("div",{className:"popup__amount",children:[Object(j.jsx)("div",{className:"popup__amount-button",onClick:function(){return i("-")},children:"-"}),t.amount,Object(j.jsx)("div",{className:"popup__amount-button",onClick:function(){return i("+")},children:"+"})]}),Object(j.jsx)("button",{className:"popup__buy-button ".concat(r?"popup__buy-button--active":""),onClick:function(){return function(e){var t=e.setStatus,n=e.setTrigger,c=e.pick;e.status&&(console.log(c),fetch("serwer.com/api/order",{method:"POST",body:JSON.stringify({id:c.productID,amount:c.amount,item:c.item,version:c.version}),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then((function(e){if(e.ok)return n(!1);throw Error(e.statusText)})).catch((function(e){t("err"),console.error(e)})))}({setStatus:c,setTrigger:s,pick:t,status:r})},children:"Dodaj do koszyka"})]})]})},v=function(e){var t=e.setTrigger;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"background",onClick:function(){return t(!1)}}),Object(j.jsx)("div",{className:"loader"})]})},_=function(e){var t=e.setTrigger;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"background",onClick:function(){return t(!1)}}),Object(j.jsxs)("div",{className:"popup",children:[Object(j.jsx)("div",{className:"popup__close-button",onClick:function(){return t(!1)}}),Object(j.jsx)("div",{className:"popup__message",children:"Ups. Co\u015b posz\u0142o nie tak. Od\u015bwie\u017c stron\u0119 lub spr\xf3buj ponownie p\xf3\u017aniej."})]})]})},h=function(e){var t=e.setTrigger,n=e.source,s=Object(c.useReducer)(l,null),i=Object(r.a)(s,2),o=i[0],a=i[1],u=Object(c.useState)(null),p=Object(r.a)(u,2),h=p[0],f=p[1],x=Object(c.useState)(null),g=Object(r.a)(x,2),k=g[0],N=g[1],y=Object(c.useState)(null),S=Object(r.a)(y,2),w=S[0],T=S[1],P=Object(c.useState)("load"),C=Object(r.a)(P,2),z=C[0],I=C[1],E={dispatch:a,setProduct:f,setItems:N,setVersions:T,setStatus:I,source:n};if(Object(c.useEffect)((function(){return d(E)}),[]),Object(c.useEffect)((function(){return function(e){if(e){var t={amount:e.amount,itemPick:e.itemPick,versionPick:e.versionPick};localStorage.setItem(e.productID,JSON.stringify(t))}}(o)}),[o]),"load"===z)return Object(j.jsx)(v,{setTrigger:t});if("err"===z)return Object(j.jsx)(_,{setTrigger:t});var F=((Number(null===o||void 0===o?void 0:o.item.price)+Number(null===o||void 0===o?void 0:o.version.products[0].price_difference))*(null===o||void 0===o?void 0:o.amount)).toFixed(2).replace(".",",");return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"background",onClick:function(){return t(!1)}}),Object(j.jsxs)("div",{className:"popup",children:[Object(j.jsx)("div",{className:"popup__image-container",children:Object(j.jsx)("img",{className:"popup__image",src:null===o||void 0===o?void 0:o.version.products[0].url,alt:"zdj\u0119cie produktu"})}),Object(j.jsxs)("div",{className:"popup__menu",children:[Object(j.jsx)("div",{className:"popup__header",children:h.name}),Object(j.jsx)("div",{className:"popup__close-button",onClick:function(){return t(!1)}}),Object(j.jsx)("div",{className:"popup__price",children:F+" z\u0142"}),Object(j.jsx)(m,{items:k,pick:o,dispatch:a}),Object(j.jsx)(b,{versions:w,dispatch:a}),Object(j.jsx)(O,{pick:o,dispatch:a,setStatus:I,setTrigger:t})]})]})]})};var f=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)(null),o=Object(r.a)(i,2),a=o[0],u=o[1];return Object(j.jsxs)("div",{className:"page",children:[Object(j.jsx)("button",{className:"page__button",onClick:function(){u("https://my-json-server.typicode.com/KieratPawel/popup/db"),s(!0)},children:"Wy\u015bwietl produkt"}),n?Object(j.jsx)(h,{setTrigger:s,source:a}):""]})};n(11);i.a.render(Object(j.jsx)(f,{}),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.2be28b01.chunk.js.map